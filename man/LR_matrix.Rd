% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/LR_matrix.R
\name{LR_matrix}
\alias{LR_matrix}
\title{Create LR Feature Matrix}
\usage{
LR_matrix(lr_list, rank_table, cutoff = 0.05, value = "pval", verbose = TRUE)
}
\arguments{
\item{lr_list}{A named list of data frames from loadingLR_cellchat, where each element 
is a sample with columns: source, target, interaction_name, pval/prob}

\item{rank_table}{A data frame containing ranked LR pairs (output from screenLR)}

\item{cutoff}{Significance cutoff threshold (default: 0.05)}

\item{value}{Type of values in lr_list, "pval" or "prob" (default: "pval")}

\item{verbose}{Logical, whether to print progress messages (default: TRUE)}
}
\value{
A matrix with LR pairs as rows and samples as columns, containing 
        counts of source-target cell type pairs with significant interactions
}
\description{
Creates a feature matrix where rows represent ligand-receptor pairs and columns 
represent samples. Each cell contains the count of source-target cell type
pairs with significant interactions for that LR pair in that sample.
Output is formatted for downstream analysis with limma.
}
\examples{
\dontrun{
# Load LR data from CellChat objects
LR_pairs_list <- loadingLR_cellchat(sample = sample, directory = directory, value = "pval")

# Screen for top LR pairs
rank_table <- screenLR(lr_list = LR_pairs_list, type = "rank", threshold = 0.8,
                       cutoff = 0.01, value = "pval", all_pairs = FALSE)

# Create LR feature matrix
lr_matrix <- LR_matrix(lr_list = LR_pairs_list, rank_table = rank_table, 
                       cutoff = 0.05, value = "pval")
}

}
