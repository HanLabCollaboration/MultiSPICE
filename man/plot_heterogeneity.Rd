% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/heterogeneity.R
\name{plot_heterogeneity}
\alias{plot_heterogeneity}
\title{Plot Heterogeneity Results}
\usage{
plot_heterogeneity(
  heterogeneity_results,
  plot_type = "frequency",
  top_n = 20,
  color_by = "frequency",
  title = "Feature Heterogeneity Across Samples"
)
}
\arguments{
\item{heterogeneity_results}{Data frame output from calculate_heterogeneity()}

\item{plot_type}{Character string specifying plot type:
\itemize{
  \item "frequency" (default): Barplot showing how many samples each feature appears in
  \item "scatter": Scatter plot showing mean value vs. frequency
}}

\item{top_n}{Integer specifying number of features to display. Default is 20.}

\item{color_by}{Character string specifying column to use for coloring.
Default is "frequency". Set to NULL for uniform color.}

\item{title}{Character string for plot title. Default is "Feature Heterogeneity Across Samples"}
}
\value{
A ggplot2 object
}
\description{
Visualize heterogeneity of features across samples. Creates visualizations
to show which features are consistent vs. variable across samples.
}
\examples{
\dontrun{
# Load data
lr_data <- loadingLR_cellchat(sample = sample_names,
                              directory = data_dir,
                              value = "pval")

# Calculate heterogeneity
het_results <- calculate_heterogeneity(lr_data, method = "frequency")

# Create frequency barplot
p1 <- plot_heterogeneity(het_results, plot_type = "frequency", top_n = 20)
print(p1)

# Create scatter plot if CV was calculated
het_results_cv <- calculate_heterogeneity(lr_data, method = "all")
p2 <- plot_heterogeneity(het_results_cv, plot_type = "scatter")
print(p2)
}

}
