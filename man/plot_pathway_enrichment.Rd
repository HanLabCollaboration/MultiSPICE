% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PWY_enrich.R
\name{plot_pathway_enrichment}
\alias{plot_pathway_enrichment}
\title{Plot Pathway Enrichment Results}
\usage{
plot_pathway_enrichment(
  enrichment_results,
  fdr_threshold = 0.05,
  top_n = 20,
  colors = c(Up = "#377EB8", Down = "#E41A1C", Mixed = "purple"),
  title = "Pathway Enrichment Analysis",
  subtitle = "Up = enriched in treatment, Down = enriched in control",
  x_label = "-log10(FDR)",
  y_label = "Pathway",
  text_size = 10
)
}
\arguments{
\item{enrichment_results}{A data frame containing pathway enrichment results from limma's fry() or camera().
Must contain columns: "FDR" (or "adj.P.Val"), "PValue", and "Direction".
Row names should be pathway names.}

\item{fdr_threshold}{Numeric value specifying the FDR threshold for significance. Default is 0.05.}

\item{top_n}{Integer specifying the number of top pathways to show if no significant pathways are found.
Default is 20.}

\item{colors}{Named character vector of colors for "Up", "Down", and "Mixed" directions.
Default is c("Up" = "#377EB8", "Down" = "#E41A1C", "Mixed" = "purple").}

\item{title}{Character string for the plot title. Default is "Pathway Enrichment Analysis".}

\item{subtitle}{Character string for the plot subtitle. Default is "Up = enriched in treatment, Down = enriched in control".}

\item{x_label}{Character string for the x-axis label. Default is "-log10(FDR)".}

\item{y_label}{Character string for the y-axis label. Default is "Pathway".}

\item{text_size}{Numeric value for the pathway label text size. Default is 10.}
}
\value{
A ggplot2 object.
}
\description{
Create a barplot to visualize pathway enrichment results from limma's fry() or camera() analysis.
The plot displays pathways ranked by significance with bars colored by direction of enrichment.
}
\details{
This function visualizes pathway enrichment analysis results by creating a horizontal barplot.
Pathways are ranked by significance (FDR), and bar colors indicate the direction of enrichment:
- "Up": Pathway is upregulated in the treatment/contrast group
- "Down": Pathway is downregulated in the treatment/contrast group
- "Mixed": Pathway contains both up and down regulated LR pairs

If no pathways meet the FDR threshold, the function will display the top N pathways by p-value.
}
\examples{
\dontrun{
# Run pathway enrichment analysis
pathway_sets <- create_pathway_geneset(species = "human")
pathway_index <- lapply(pathway_sets, function(lr_pairs) {
  which(rownames(expr_matrix) \%in\% lr_pairs)
})
fry_results <- fry(expr_matrix, index = pathway_index, design = design, contrast = 2)

# Plot results
p <- plot_pathway_enrichment(fry_results)
print(p)

# Customize plot
p_custom <- plot_pathway_enrichment(
  fry_results,
  fdr_threshold = 0.01,
  title = "Pathway Enrichment: mCRC vs priCRC",
  subtitle = "Up = enriched in mCRC, Down = enriched in priCRC"
)
}

}
