% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/matrix_heatmap.R
\name{matrix_heatmap}
\alias{matrix_heatmap}
\title{Create Heatmap Visualization of Feature Matrix}
\usage{
matrix_heatmap(
  matrix,
  features = NULL,
  scale_rows = FALSE,
  column_annotation = NULL,
  annotation_name = "Cluster",
  annotation_colors = NULL,
  name = "Counts",
  cluster_rows = TRUE,
  cluster_columns = TRUE,
  show_row_names = NULL,
  show_column_names = TRUE,
  row_names_gp = gpar(fontsize = 8),
  column_names_gp = gpar(fontsize = 10),
  colors = NULL,
  main = NULL
)
}
\arguments{
\item{matrix}{A feature matrix with features as rows and samples as columns
(output from LR_matrix or PWY_matrix)}

\item{features}{Character vector of feature names to plot. If NULL, plots all features (default: NULL)}

\item{scale_rows}{Logical, whether to scale rows (Z-score normalization) (default: FALSE)}

\item{column_annotation}{Named vector or data frame for column annotations (e.g., cluster assignments).
Names should match column names of the matrix. If NULL, no annotation is added (default: NULL)}

\item{annotation_name}{Name for the annotation legend title when column_annotation is a vector (default: "Cluster")}

\item{annotation_colors}{Named list of colors for annotations. List names should match 
annotation column names. If NULL, uses default colors (default: NULL)}

\item{name}{Title for the heatmap legend (default: "Counts")}

\item{cluster_rows}{Logical, whether to cluster rows (default: TRUE)}

\item{cluster_columns}{Logical, whether to cluster columns (default: TRUE)}

\item{show_row_names}{Logical, whether to show row names (default: TRUE for <50 rows, FALSE otherwise)}

\item{show_column_names}{Logical, whether to show column names (default: TRUE)}

\item{row_names_gp}{Text properties for row names (default: fontsize = 8)}

\item{column_names_gp}{Text properties for column names (default: fontsize = 10)}

\item{colors}{Color scheme for the heatmap. If NULL, uses a blue gradient (default: NULL)}

\item{main}{Title for the heatmap (default: NULL)}
}
\value{
A ComplexHeatmap object
}
\description{
Creates a heatmap visualization of LR pair or pathway feature matrices.
Features (LR pairs/pathways) are shown as rows and samples as columns.
}
\examples{
\dontrun{
# Create LR feature matrix
lr_matrix <- LR_matrix(lr_list = LR_pairs_list, rank_table = rank_table, 
                       cutoff = 0.01, value = "pval")

# Visualize all features
matrix_heatmap(lr_matrix, name = "LR Counts", main = "LR Pair Feature Matrix")

# Perform clustering
pca_results <- dimensionality_clustering(lr_matrix, clustering_method = "louvain")

# Visualize with cluster annotations
matrix_heatmap(lr_matrix, column_annotation = pca_results$clusters,
               name = "LR Counts", main = "LR Pairs with Cluster Annotations")

# Visualize with row scaling
matrix_heatmap(lr_matrix, scale_rows = TRUE, name = "Z-score", 
               main = "LR Pair Feature Matrix (Scaled)")

# Visualize selected features only
top_features <- c("CXCL12_CXCR4", "VEGFA_VEGFR2", "TNF_TNFRSF1A")
matrix_heatmap(lr_matrix, features = top_features, name = "LR Counts", 
               main = "Top LR Pairs")
}

}
